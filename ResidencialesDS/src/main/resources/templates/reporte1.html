<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>DS-Residenciales</title>
        <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src=
        "https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.js"></script>
        <link
            rel="stylesheet"
            href=
            "https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.css"
            />
        <link
            rel=
            "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
            type="text/css"
            />

        <script src=
                "https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js">
        </script>
        <script src=
                "https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js">
        </script>

        <script src=
                "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1/Chart.min.js">
        </script>

        <style>
            body {
                text-align: center;
                color: green;
            }
            h2 {
                text-align: center;
                font-family: "Verdana", sans-serif;
                font-size: 40px;
            }
        </style>
    </head>
    <body class="sb-nav-fixed">
        <div th:object="${residencial}"></div>
    <th:block th:replace="~{layout/plantilla :: header}"></th:block>
    <!-- barra vertical -->
    <div id="layoutSidenav">
        <th:block th:replace="~{layout/plantilla :: menu}"></th:block>
        <div th:object="${ticketMesActual}"></div>
        <div th:object="${ticketMesAnterior}"></div>
        <div id="layoutSidenav_content">
            <!-- contenido -->
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 text-center">
                        <h2>Reporte de eventos</h2>
                        <h5 th:text="'Eventos activos de la residencial ' + ${residencial.name} + ' a la fecha '+${strFecha}"></h5>
                    </div>

                    <div id="donut-chart" ></div>
                </div>
                <div class="row">
                    <!-- Gráfica de tickets abiertos y cerrados -->
                    <div class="row">
                        <div class="col-md-6" id="ticketsMes" style="width: 50%;">
                        </div>

                        <!-- Otras gráficas aquí -->
                        <div class="col-md-6" id="ticketsAnterior" style="width: 50%;">
                        </div>
                    </div>
                </div>

                <script th:inline="javascript">
                    /* Obtener los datos del modelo */

                    var tickets = /*[[${tickets}]]*/ [];
                    var total = /*[[${total}]]*/[];
                    /* Generar los datos del gráfico donut */
                    
                    var datos = /*[[${datos}]]*/[];
                    var datosMesAnt = /*[[${ticketMesAnterior}]]*/[];
                    var totalMesActual = /*[[${totalMes}]]*/[];
                    var totalMesAnterior = /*[[${totalAnterior}]]*/[];
                    // Obtener los datos para la gráfica de tickets por usuario
                    var datosUsuarios = 5; ///* Obtener tus datos de tickets por usuario */;

                    // Obtener el contexto de los canvas de las gráficas
                    /*var ctxAbiertosCerrados = document.getElementById('ticketsAbiertosCerradosDiv').getContext('2d');
                    var ctxUsuarios = document.getElementById('grafica3').getContext('2d');*/
                    /* Crear el gráfico donut */
                    var chart = bb.generate({
                        data: {
                            columns: tickets,
                            type: "donut",
                            onclick: function (d, i) {
                                console.log("onclick", d, i);
                            },
                            onover: function (d, i) {
                                console.log("onover", d, i);
                            },
                            onout: function (d, i) {
                                console.log("onout", d, i);
                            },
                        },
                        donut: {
                            title: "Tickets abiertos: " + total.toString()
                        },
                        bindto: "#donut-chart"
                    });

                    // Crear la gráfica de tickets abiertos y cerrados
                    var chart2 = bb.generate({
                        data: {
                            columns: datos,
                            type: "donut",
                            onclick: function (d, i) {
                                console.log("onclick", d, i);
                            },
                            onover: function (d, i) {
                                console.log("onover", d, i);
                            },
                            onout: function (d, i) {
                                console.log("onout", d, i);
                            },
                            colors: {
                                
                                Cerrado: 'green',   // Color para "Cerrados"
                                Abierto: 'red' // Color para "Abiertos"
                            }
                        },
                        donut: {
                            title: "Mes Actual: " + totalMesActual.toString()
                        },
                        bindto: "#ticketsMes"
                    });
                    
                    // Crear la gráfica de tickets abiertos y cerrados
                    var chart3 = bb.generate({
                        data: {
                            columns: datosMesAnt,
                            type: "donut",
                            onclick: function (d, i) {
                                console.log("onclick", d, i);
                            },
                            onover: function (d, i) {
                                console.log("onover", d, i);
                            },
                            onout: function (d, i) {
                                console.log("onout", d, i);
                            },
                            colors: {
                                
                                Cerrado: 'green',   // Color para "Cerrados"
                                Abierto: 'red' // Color para "Abiertos"
                            }
                        },
                        donut: {
                            title: "Mes Anterior: " + totalMesAnterior.toString()
                        },
                        bindto: "#ticketsAnterior"
                    });
                    /*var ticketsAbiertosCerradosChart = new Chart(ctxAbiertosCerrados, {
                        type: 'pie',
                        data: {
                            labels: ['Abiertos', 'Cerrados'],
                            datasets: [{
                                    data: [datosTicketsAbiertos, datosTicketsCerrados],
                                    backgroundColor: ['rgba(255, 99, 132, 0.7)', 'rgba(75, 192, 192, 0.7)']
                                }]
                        }
                    });

                    // Crear la gráfica de tickets por usuario
                    var ticketsPorUsuarioChart = new Chart(ctxUsuarios, {
                        type: 'pie',
                        data: {
                            labels: [['Usuario']], ///* Etiquetas de usuarios ,
                            datasets: [{
                                    data: datosUsuarios,
                                    backgroundColor: ['rgba(255, 99, 132, 0.7)', 'rgba(75, 192, 192, 0.7)']///* Colores para los usuarios 
                                }]
                        }
                    });*/
                </script>
            </div>

            <th:block th:replace="~{layout/plantilla :: footer}" class="py-4 bg-light"></th:block> 
        </div>

    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/mensajes.js"></script>
</body>
</html>
